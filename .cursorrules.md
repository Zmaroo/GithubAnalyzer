# Cursor Rules for GitHub Analyzer

This project aims to be a tool that an AI model/agent can use to gain deep knowledge and insights about Github repositories and code bases.

## Project Structure

The project follows this structure:

### Source Code (`src/GithubAnalyzer/`)

- `config/`     - Configuration management
  - `settings.py` - Main application settings
  - `language_config.py` - Language-specific configuration
  - `__init__.py` - Configuration exports

- `models/`     - Data models and domain objects
  - `core/` - Core models (errors, base classes)
  - `analysis/` - Analysis-related models
  - `storage/` - Storage-related models

- `services/`   - Business logic and services
  - `core/` - Core services
    - `parsers/` - Code parsing implementations
  - `analysis/` - Analysis services
  - `storage/` - Storage services

- `utils/`      - Utility functions and helpers
- `types/`      - Type definitions

### Tests

- `tests/`
  - `unit/`           - Unit tests
  - `integration/`    - Integration tests
  - `test_parsers/`   - Parser-specific tests

## Core Files

- `pyproject.toml`         - Project metadata and dependencies
- `pytest.ini`            - Test configuration
- `.pre-commit-config.yaml` - Git hooks for code quality
- `.cursorrules.md`       - Development guidelines

## Testing Requirements

### Tree-sitter Parser Testing

The tree-sitter parser implementation is a critical component. Any changes to these files require running parser tests:

- `src/GithubAnalyzer/services/core/parsers/tree_sitter.py`
- `src/GithubAnalyzer/services/core/parsers/base.py` (if changes affect tree-sitter)
- Any files modifying tree-sitter query patterns or language configurations

To verify changes:
```bash
pytest tests/test_parsers -v
```

## Tree-sitter Language Support

This project uses pre-built tree-sitter language parsers installed via pip. The supported languages are defined in `config/language_config.py`. To add support for a new language:

1. Install the corresponding tree-sitter parser package
2. Add the language mapping to `TREE_SITTER_LANGUAGES` in `language_config.py`
3. Add appropriate query patterns in `tree_sitter.py`
4. Add tests for the new language parser

## Import Rules

Always use absolute imports. For example:
```python
from GithubAnalyzer.models.core.errors import ParseError
```

## Configuration Management

1. All application settings must be defined in `config/settings.py`
2. Import settings from `config/__init__.py`, not directly from `settings.py`
3. Language-specific configuration belongs in `language_config.py`
4. Framework patterns belong in `models/analysis/patterns.py`

## Best Practices

1. Keep models and services separate
   - Models go in `models/`
   - Services go in `services/`
   - No models in services directory

2. Configuration Management
   - Use `ConfigurableService` base class for services needing configuration
   - Validate all configuration in `_validate_config` method
   - Don't modify configuration after service initialization

3. Error Handling
   - Use appropriate error classes from `models/core/errors.py`
   - Add new error types to the core errors module if needed
   - Include meaningful error messages

4. Testing
   - Write tests for all new functionality
   - Organize tests by type (unit, integration, parsers)
   - Ensure all tests pass before committing

5. Code Quality
   - Run pre-commit hooks before committing
   - Fix all linting and type checking errors
   - Keep functions and methods focused and well-documented
